Freelancer Analytics — Отчет по архитектуре и подходу

Цель проекта.

Разработать прототип системы, которая анализирует статистические данные о доходах фрилансеров и предоставляет ответы на запросы, используя:

1. Cтруктурированные данные (CSV - PostgreSQL)
2. Взаимодействие через естественный язык (LLM)
3. Интерфейс командной строки (CLI)

Проект позволяет пользователю задать произвольный вопрос о данных, получить SQL-запрос, сформированный LLM, выполнить его на базе данных и получить ответ.

Архитектура.

Проект основан на микроархитектуре LLM + SQL. Состоит из следующих компонентов:\
PostgreSQL — хранилище данных, загруженных из CSV-файла.\
Pandas + SQLAlchemy — загрузка, обработки и выполнения SQL-запросов.\
OpenAI GPT-4 — преобразует текстовый вопрос в SQL-запрос.\
CLI-интерфейс (Typer) — точка входа для пользователя, где можно задать вопрос или запустить чат.\
Tabulate — форматирует результаты SQL-запросов в таблицы.

Почему LLM + SQL?

Плюсы:\
Пользователю не нужно знать SQL.\
Гибкий способ анализа данных (вопрос - ответ).\
Масштабируется под разные дата данные с минимальной доработкой.

Минусы:\
Возможны ошибки генерации SQL.\
Требуется обработка исключений, защита от небезопасных запросов.

Почему CLI-интерфейс?

Можно использовать систему без создания UI.\
Интегрируется в dev-среду (терминал, скрипты).\
Расширяемый: можно добавить логирование, сохранение истории и т.д.

Схема работы:

1. Пользователь задаёт вопрос
2. Формирование промпта для GPT
3. Запрос к OpenAI
4. Полученный SQL-запрос
5. Pandas + SQLAlchemy обрабатывает результат
6. Табличный вывод в консоль (tabulate)

Структура проекта:

data/freelancer_earnings_bd.csv  # Исходный датасет\
cli.py # CLI-интерфейс\
.env # Секреты (API ключ, DB URL)\
db/database.py # Подключение к PostgreSQL\
db/loader.py # Загрузка CSV - DB, исполнение SQL\
models/query_parser.py   # Преобразование вопроса - SQL

Пример использования:

python cli.py ask "Какой средний доход у фрилансеров, использующих криптовалюту?"\
GPT формирует SQL:\
SELECT AVG(earnings_usd)\
FROM freelancer_data\
WHERE payment_method = 'Crypto';\
Ответ:\
avg\
5,139.30





